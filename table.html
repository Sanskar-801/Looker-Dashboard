<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Table</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            color: #495057;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        th:first-child {
            padding-left: 24px;
        }
        
        tbody tr {
            border-bottom: 1px solid #e9ecef;
            transition: background-color 0.2s;
        }
        
        tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        tbody tr:last-child {
            border-bottom: none;
        }
        
        td {
            padding: 16px;
            vertical-align: middle;
        }
        
        td:first-child {
            padding-left: 24px;
            font-weight: 500;
            color: #212529;
        }
        
        .metric-cell {
            line-height: 1.6;
        }
        
        .actual-value {
            font-size: 18px;
            font-weight: 600;
            color: #212529;
            display: block;
            margin-bottom: 4px;
        }
        
        .plan-value {
            font-size: 11px;
            color: #6c757d;
            display: block;
            margin-bottom: 4px;
        }
        
        .variance {
            font-size: 12px;
            font-weight: 500;
            display: block;
        }
        
        .variance.positive {
            color: #00C853;
        }
        
        .variance.negative {
            color: #FF5252;
        }
        
        .variance.neutral {
            color: #9E9E9E;
        }
        
        .roas-cell {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            font-weight: 600;
            text-align: center;
        }
        
        .roas-cell.good {
            background: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%);
            color: white;
        }
        
        .roas-cell.average {
            background: linear-gradient(135deg, #FFC107 0%, #FFD54F 100%);
            color: #333;
        }
        
        .roas-cell.poor {
            background: linear-gradient(135deg, #FF5252 0%, #FF7043 100%);
            color: white;
        }
        
        .total-row {
            background: #f8f9fa;
            font-weight: 600;
            border-top: 2px solid #dee2e6;
        }
        
        .total-row td {
            padding: 18px 16px;
        }
        
        .currency::before {
            content: '₹';
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            th, td {
                padding: 10px 8px;
                font-size: 12px;
            }
            
            .actual-value {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="table-container">
        <table id="performanceTable">
            <thead>
                <tr>
                    <th>Course</th>
                    <th>Leads</th>
                    <th>Admissions</th>
                    <th>Revenue</th>
                    <th>P&L</th>
                    <th>Spend</th>
                    <th>CPL</th>
                    <th>CPA</th>
                    <th>ROAS ⭐</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Data will be inserted here -->
            </tbody>
        </table>
    </div>

    <script>
        // Sample data structure - Replace this with your Looker Studio data
        const data = [
            {
                course: "MBA",
                leads: { actual: 1850, plan: 1700 },
                admissions: { actual: 295, plan: 272 },
                revenue: { actual: 885, plan: 816 },
                pl: { actual: 266, plan: 245 },
                spend: { actual: 245, plan: 255 },
                cpl: { actual: 132, plan: 150 },
                cpa: { actual: 831, plan: 938 },
                roas: { actual: 3.6, plan: 3.2 }
            },
            {
                course: "Executive MBA",
                leads: { actual: 920, plan: 850 },
                admissions: { actual: 147, plan: 136 },
                revenue: { actual: 588, plan: 544 },
                pl: { actual: 176, plan: 163 },
                spend: { actual: 142, plan: 145 },
                cpl: { actual: 154, plan: 171 },
                cpa: { actual: 966, plan: 1066 },
                roas: { actual: 4.1, plan: 3.8 }
            },
            {
                course: "MCA",
                leads: { actual: 1120, plan: 1050 },
                admissions: { actual: 178, plan: 168 },
                revenue: { actual: 445, plan: 420 },
                pl: { actual: 134, plan: 126 },
                spend: { actual: 125, plan: 130 },
                cpl: { actual: 112, plan: 124 },
                cpa: { actual: 702, plan: 774 },
                roas: { actual: 3.6, plan: 3.2 }
            },
            {
                course: "BBA",
                leads: { actual: 890, plan: 800 },
                admissions: { actual: 142, plan: 128 },
                revenue: { actual: 355, plan: 320 },
                pl: { actual: 107, plan: 96 },
                spend: { actual: 118, plan: 120 },
                cpl: { actual: 133, plan: 150 },
                cpa: { actual: 831, plan: 938 },
                roas: { actual: 3.0, plan: 2.7 }
            },
            {
                course: "BCA",
                leads: { actual: 670, plan: 600 },
                admissions: { actual: 110, plan: 96 },
                revenue: { actual: 337, plan: 300 },
                pl: { actual: 101, plan: 90 },
                spend: { actual: 115, plan: 100 },
                cpl: { actual: 172, plan: 167 },
                cpa: { actual: 1045, plan: 1042 },
                roas: { actual: 2.9, plan: 3.0 }
            }
        ];

        function calculateVariance(actual, plan) {
            if (plan === 0) return 0;
            return ((actual - plan) / plan) * 100;
        }

        function formatVariance(variance) {
            const rounded = Math.round(variance * 10) / 10;
            if (variance > 0) {
                return `<span class="variance positive">↗ +${rounded}%</span>`;
            } else if (variance < 0) {
                return `<span class="variance negative">↘ ${rounded}%</span>`;
            } else {
                return `<span class="variance neutral">↔ 0%</span>`;
            }
        }

        function formatNumber(num) {
            return num.toLocaleString('en-IN');
        }

        function formatCurrency(num) {
            return `₹${num}k`;
        }

        function createMetricCell(actual, plan, isCurrency = false, isDecimal = false) {
            const variance = calculateVariance(actual, plan);
            let actualDisplay, planDisplay;
            
            if (isDecimal) {
                actualDisplay = actual.toFixed(1);
                planDisplay = plan.toFixed(1);
            } else if (isCurrency) {
                actualDisplay = formatCurrency(actual);
                planDisplay = formatCurrency(plan);
            } else {
                actualDisplay = formatNumber(actual);
                planDisplay = formatNumber(plan);
            }
            
            return `
                <div class="metric-cell">
                    <span class="actual-value">${actualDisplay}</span>
                    <span class="plan-value">Plan: ${planDisplay}</span>
                    ${formatVariance(variance)}
                </div>
            `;
        }

        function getROASClass(roas) {
            if (roas >= 3.5) return 'good';
            if (roas >= 3.0) return 'average';
            return 'poor';
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            let html = '';
            
            // Totals calculation
            const totals = {
                leads: { actual: 0, plan: 0 },
                admissions: { actual: 0, plan: 0 },
                revenue: { actual: 0, plan: 0 },
                pl: { actual: 0, plan: 0 },
                spend: { actual: 0, plan: 0 },
                cpl: { actual: 0, plan: 0 },
                cpa: { actual: 0, plan: 0 },
                roas: { actual: 0, plan: 0 }
            };
            
            data.forEach(row => {
                const roasClass = getROASClass(row.roas.actual);
                
                html += `
                    <tr>
                        <td>${row.course}</td>
                        <td>${createMetricCell(row.leads.actual, row.leads.plan)}</td>
                        <td>${createMetricCell(row.admissions.actual, row.admissions.plan)}</td>
                        <td>${createMetricCell(row.revenue.actual, row.revenue.plan, true)}</td>
                        <td>${createMetricCell(row.pl.actual, row.pl.plan, true)}</td>
                        <td>${createMetricCell(row.spend.actual, row.spend.plan, true)}</td>
                        <td>${createMetricCell(row.cpl.actual, row.cpl.plan, true)}</td>
                        <td>${createMetricCell(row.cpa.actual, row.cpa.plan, true)}</td>
                        <td class="roas-cell ${roasClass}">
                            ${createMetricCell(row.roas.actual, row.roas.plan, false, true)}
                        </td>
                    </tr>
                `;
                
                // Accumulate totals
                Object.keys(totals).forEach(key => {
                    totals[key].actual += row[key].actual;
                    totals[key].plan += row[key].plan;
                });
            });
            
            // Calculate averages for CPL, CPA, ROAS
            const rowCount = data.length;
            ['cpl', 'cpa', 'roas'].forEach(key => {
                totals[key].actual = Math.round(totals[key].actual / rowCount);
                totals[key].plan = Math.round(totals[key].plan / rowCount);
            });
            
            const totalRoasClass = getROASClass(totals.roas.actual / rowCount);
            
            // Add totals row
            html += `
                <tr class="total-row">
                    <td>Total</td>
                    <td>${createMetricCell(totals.leads.actual, totals.leads.plan)}</td>
                    <td>${createMetricCell(totals.admissions.actual, totals.admissions.plan)}</td>
                    <td>${createMetricCell(totals.revenue.actual, totals.revenue.plan, true)}</td>
                    <td>${createMetricCell(totals.pl.actual, totals.pl.plan, true)}</td>
                    <td>${createMetricCell(totals.spend.actual, totals.spend.plan, true)}</td>
                    <td>${createMetricCell(totals.cpl.actual, totals.cpl.plan, true)}</td>
                    <td>${createMetricCell(totals.cpa.actual, totals.cpa.plan, true)}</td>
                    <td class="roas-cell ${totalRoasClass}">
                        ${createMetricCell(totals.roas.actual / rowCount, totals.roas.plan / rowCount, false, true)}
                    </td>
                </tr>
            `;
            
            tbody.innerHTML = html;
        }

        // Initialize table
        renderTable();

        // Function to update data from Looker Studio
        window.updateTableData = function(newData) {
            data.length = 0;
            data.push(...newData);
            renderTable();
        };
    </script>
</body>
</html>